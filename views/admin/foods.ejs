<%- include('../partials/_headerAdmin') %>

    <h1>Manage Foods</h1>

    <div class="header-actions">
        <a href="/admin/food/add" class="btn btn-add">+ Tambah Makanan</a>

        <form action="/admin/foods" method="GET" class="search-form">
            <input type="text" name="search" class="search-input" 
                   placeholder="Cari nama, stok, atau harga..." 
                   value="<%= search %>"> <button type="submit" class="btn-search">Cari</button>
            <% if(search) { %>
                <a href="/admin/foods" class="btn" style="background:#666; padding: 8px 15px;">Reset</a>
            <% } %>
        </form>
        
        <a href="/admin/food/export" class="btn btn-export">Export CSV</a>
    </div>

    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>
                        Nama Makanan 
                        <a href="?sort=name_food&order=ASC">▲</a>
                        <a href="?sort=name_food&order=DESC">▼</a>
                    </th>
                    <th>
                        Stok 
                        <a href="?sort=qty_food&order=ASC">▲</a>
                        <a href="?sort=qty_food&order=DESC">▼</a>
                    </th>
                    <th>
                        Harga 
                        <a href="?sort=price_food&order=ASC">▲</a>
                        <a href="?sort=price_food&order=DESC">▼</a>
                    </th>
                    <th>Manage</th>
                </tr>
            </thead>
            <tbody>
                <% if(data.length > 0) { %>
                    <% data.forEach((item, index) => { %>
                    <tr>
                        <td><%= item.name_food %></td>
                        <td><%= item.qty_food %></td>
                        <td>Rp <%= new Intl.NumberFormat('id-ID').format(item.price_food) %></td>
                        <td class="actions">
                            <a href="/admin/food/edit/<%= item.id_food %>" class="btn btn-edit">Edit</a>
                            
                            <form action="/admin/food/delete/<%= item.id_food %>" method="POST" style="display:inline;">
                                <button type="submit" class="btn btn-delete" onclick="return confirm('Yakin hapus?');">Hapus</button>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                <% } else { %>
                    <tr>
                        <td colspan="6" style="text-align:center;">Data tidak ditemukan.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>

<%- include('../partials/_footerAdmin') %>
