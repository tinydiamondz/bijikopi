<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main Menu Coffee Shop - Biji Kopi</title>
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/main-menu.css">
    <link rel="stylesheet" href="/css/carousel.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        .voucher-container {
            margin: 20px auto;
            max-width: 600px;
            padding: 0 20px;
        }
        .voucher-card {
            background: linear-gradient(135deg, #d4a373 0%, #8b5e3c 100%);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            box-shadow: 0 10px 20px rgba(212, 163, 115, 0.3);
            position: relative;
            overflow: hidden;
            border: 2px dashed rgba(255,255,255,0.5);
        }
        .voucher-left h3 {
            margin: 0;
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: #fff;
        }
        .voucher-left p {
            margin: 5px 0 0;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .btn-claim {
            background-color: white;
            color: #8b5e3c;
            border: none;
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Poppins', sans-serif;
        }
        .btn-claim:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .btn-claim:disabled {
            background-color: #ccc;
            color: #666;
            cursor: not-allowed;
            transform: none;
        }
        .claimed-badge {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    

    <nav>
    <div class="nav-left">
        <span class="points-display">
            ‚≠ê <%= point %> pts
        </span>
        <span class="date-display"><%= currentDateWIB %></span>
    </div>

    <div class="nav-center">
        <a href="/" class="<%= typeof page !== 'undefined' && page === 'main' ? 'active' : '' %>">MAIN</a>
        <a href="/foods" class="<%= typeof page !== 'undefined' && page === 'foods' ? 'active' : '' %>">FOODS</a>
        <a href="/drinks" class="<%= typeof page !== 'undefined' && page === 'drinks' ? 'active' : '' %>">DRINKS</a>
        
        <% if (role === "customer") { %>
            <a href="/cart" class="<%= typeof page !== 'undefined' && page === 'cart' ? 'active' : '' %>">CART</a>
            <a href="/transactions" class="<%= typeof page !== 'undefined' && page === 'history' ? 'active' : '' %>">HISTORY</a>
        <% } %>

        <% if (role === "admin") { %>
            <a href="/admin/foods">ADMIN ONLY</a>
        <% } %>

        <a href="/forum" class="<%= typeof page !== 'undefined' && page === 'forum' ? 'active' : '' %>">FORUM</a>
    </div>

    <div class="nav-right">
        <span class="logged-as">
            LOGGED AS <%= role === "admin" ? user.fullname_admin : user.fullname_customer %>
        </span>
        <a href="/logout" class="login-btn">LOGOUT</a>
    </div>
</nav>


    <div class="container">
        <div class="main-logo">
            <div class="logo-frame">
                <img src="/images/main/logo-bidji.png" alt="Biji Kopi Logo" class="logo">
            </div>
        </div>

        <h1>Welcome to Biji Kopi!</h1>
        <p class="description">
            Di sini, aroma kopi segar menyapa setiap pengunjung begitu memasuki kafe. 
            Setiap cangkir dibuat dari biji kopi pilihan, disangrai dengan teliti, dan disajikan dengan penuh perhatian untuk memanjakan lidah Anda. 
        </p>
    </div>

    <div class="quote-section">
        <p class="quote-text">
            "Sebuah ide yang baik dimulai dengan secangkir kopi yang baik."
        </p>
        <p class="quote-author">‚Äî FILOSOFI BIJI KOPI</p>
    </div>

    <div class="banner-grid">
        <div class="banner-item">
            <img src="/images/main/gambar main (1).png" alt="Banner 1">
            <div class="banner-overlay"><p>Nikmati Kopi Segar</p></div>
        </div>
        <div class="banner-item">
            <img src="/images/main/gambar main (5).png" alt="Banner 2">
            <div class="banner-overlay"><p>Suasana Nyaman</p></div>
        </div>
        <div class="banner-item">
            <img src="/images/main/gambar main (4).png" alt="Banner 3">
            <div class="banner-overlay"><p>Pilihan Menu Lezat</p></div>
        </div>
    </div>

    <div class="special-offers-section">
        <h2>Ada apa aja di Biji Kopi?</h2>

        <% if (isSaturday) { %>
            <div class="voucher-container">
                <div class="voucher-card">
                    <div class="voucher-left">
                        <h3>üéâ SATURDAY SPECIAL!</h3>
                        <p>Dapatkan Diskon 20% untuk semua menu.</p>
                        <small style="font-size: 0.7rem; color: #eee;">*Berlaku untuk 1x transaksi hari ini</small>
                    </div>
                    <div class="voucher-right">
                        <% if (hasClaimed) { %>
                            <div class="claimed-badge">
                                <span>‚úî VOUCHER AKTIF</span>
                            </div>
                        <% } else { %>
                            <button onclick="claimVoucher()" class="btn-claim" id="claimBtn">
                                KLAIM SEKARANG
                            </button>
                        <% } %>
                    </div>
                </div>
            </div>
        <% } %>
        <div class="carousel-wrapper">
            <button class="carousel-btn prev-offer-btn">‚Üê</button>
            <div class="offers-carousel-container"> 
                <div class="offer-item carousel-slide">
                    <img src="/images/main/gambar menu (1).png" alt="Croissant">
                    <div class="offer-details"><p class="offer-name">Croissant</p><p class="offer-price-new">Rp 15K</p></div>
                </div>
                <div class="offer-item carousel-slide">
                    <img src="/images/main/gambar menu (2).png" alt="Hot Chocolate">
                    <div class="offer-details"><p class="offer-name">Hot Chocolate</p><p class="offer-price-new">Rp 25K</p></div>
                </div>
                <div class="offer-item carousel-slide">
                    <img src="/images/main/gambar menu (3).png" alt="Matcha">
                    <div class="offer-details"><p class="offer-name">Matcha Latte</p><p class="offer-price-new">Rp 55K</p></div>
                </div>
                <div class="offer-item carousel-slide">
                    <img src="/images/main/gambar menu (4).png" alt="Tiramisu">
                    <div class="offer-details"><p class="offer-name">Tiramisu Cake</p><p class="offer-price-new">Rp 30K</p></div>
                </div>
            </div>
            <button class="carousel-btn next-offer-btn">‚Üí</button>
        </div>
    </div>

    <div class="location-section">
        <h2>Temukan Lokasi Kami</h2>
        <div class="location-info">
            <div class="location-card">
                <h4>BIJI KOPI - Tangerang</h4>
                <p>Bez Plaza, Gading Serpong, Tangerang.</p>
            </div>
            <div class="location-card">
                <h4>BIJI KOPI - Bandung</h4>
                <p>Jl. Cihampelas No. 50, Bandung.</p>
            </div>
            <div class="location-card">
                <h4>BIJI KOPI - Jakarta</h4>
                <p>Kuningan, Jakarta Selatan.</p>
            </div>
            <div class="location-card">
                <h4>BIJI KOPI - Bekasi</h4>
                <p>Galaxy, Bekasi.</p>
            </div>
        </div>
    </div>

    <div class="contact-info-bar">
        <p class="curhat-text">Curhat Yuk <span>081-296-418-855</span> WhatsApp Chat Only</p>
    </div>
    
    <footer>¬© 2025 Biji Kopi ‚Äî Crafted with Biji</footer>

    <script>
        const offersContainer = document.querySelector('.offers-carousel-container');
        const offerSlides = document.querySelectorAll('.offers-carousel-container .carousel-slide');
        const prevOfferBtn = document.querySelector('.prev-offer-btn');
        const nextOfferBtn = document.querySelector('.next-offer-btn');

        if (offersContainer && offerSlides.length > 0) {
            let currentOfferSlide = 0;
            function getSlideWidth() {
                if (offerSlides.length === 0) return 0;
                return offerSlides[0].offsetWidth + 20; 
            }
            function showOfferSlide(index) {
                if (index >= offerSlides.length - 1) currentOfferSlide = 0;
                else if (index < 0) {
                    const visibleItems = Math.floor(offersContainer.offsetWidth / getSlideWidth());
                    currentOfferSlide = offersContainer.children.length - visibleItems;
                } else currentOfferSlide = index;
                offersContainer.scrollTo({ left: currentOfferSlide * getSlideWidth(), behavior: 'smooth' });
            }
            nextOfferBtn.addEventListener('click', () => showOfferSlide(currentOfferSlide + 1));
            prevOfferBtn.addEventListener('click', () => showOfferSlide(currentOfferSlide - 1));
            window.addEventListener('resize', () => showOfferSlide(currentOfferSlide));
        }
    </script>

    <script>
        document.querySelectorAll('.ripple-navbar a').forEach(link => {
            link.addEventListener('mouseenter', e => {
                const ripple = document.createElement('span');
                ripple.classList.add('ripple');
                link.appendChild(ripple);
                const rect = link.getBoundingClientRect();
                ripple.style.left = `${e.clientX - rect.left}px`;
                ripple.style.top = `${e.clientY - rect.top}px`;
                setTimeout(() => ripple.remove(), 700);
            });
        });
    </script>

    <script>
        async function claimVoucher() {
            try {
                const response = await fetch('/claim-voucher', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                const result = await response.json();

                if (result.success) {
                    alert("üéâ Selamat! Voucher berhasil diklaim. Diskon 20% akan otomatis terpasang di keranjang.");
                    // Reload halaman agar tombol berubah jadi "Voucher Aktif"
                    window.location.reload();
                } else {
                    alert("Gagal klaim: " + result.message);
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Terjadi kesalahan sistem.");
            }
        }
    </script>

</body>
</html>
